set pagination off
set logging file /workspace/htb_aswqx4d/gdb_run.log
set logging enabled on
set environment LD_PRELOAD /workspace/htb_aswqx4d/override.so
set breakpoint pending on
break __libc_start_main
run
set $base = $rdi - 0x1530
set $addr_getline_call = $base + 0x171f
break *$addr_getline_call
continue
python
import gdb
inf = gdb.selected_inferior()
count = int(gdb.parse_and_eval("(int)recorded_count"))
base_maps = int(gdb.parse_and_eval("(long)&recorded_maps"))
base_sizes = int(gdb.parse_and_eval("(long)&recorded_sizes"))
for i in range(count):
    addr_bytes = inf.read_memory(base_maps + i * 8, 8)
    size_bytes = inf.read_memory(base_sizes + i * 8, 8)
    addr = int.from_bytes(addr_bytes.tobytes(), byteorder='little', signed=False)
    size = int.from_bytes(size_bytes.tobytes(), byteorder='little', signed=False)
    gdb.write(f"map[{i}]=0x{addr:x} len={size}\n")
if count > 5:
    addr_bytes = inf.read_memory(base_maps + 5 * 8, 8)
    target = int.from_bytes(addr_bytes.tobytes(), byteorder='little', signed=False)
    gdb.execute(f"set $target = 0x{target:x}")
else:
    gdb.execute("set $target = 0")
end
x/64bx $target
quit
